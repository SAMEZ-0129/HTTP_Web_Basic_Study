# HTTP 헤더 2
캐시 기본 동작

캐시가 없을 때
- 데이터가 변경되지 않아도 계속 네트워크를 통해서 데이터를 다운로드 받아야 한다
- 인터넷 네트워크는 매우 느리고 비싸다
- 브라우저 로딩 속도가 느리다
- 사용자 경험의 저하

캐시가 있을 때
- 캐시 덕분에 캐시의 유효기간 동안 네트워크를 사용하지 않아도 데이터를 불러올 수 있다
- 비싼 네트워크 사용량을 줄일 수 있다
- 브라우저 로딩 속도가 빠르다
- 사용자 경험 향상
- 캐시 유효 시간이 초과하면, 서버를 통해 데이터를 다시 조회하고 캐시를 갱신한다 = 이때 네트워크 다운로드 발생
유효기간이 초과했다고 해도 요청하려는 데이터가 기존 만료된 데이터와 동일할 경우 굳이 다시 다운로드 해야 하나? -> 서버에서 검증을 통해 해결 가능

검증 헤더와 조건부 요청
기존에 전달했던 데이터와 서버에 요청하는 데이터가 동일하다는 것을 검증한다 -> 검증 헤더
Last-Modified: 2020-11-10 10:00:00 같은 헤더를 통해 마지막 데이터의 수정일 확인
클라이언트에서 요청 시 위 정보를 포함해서 요청 -> 서버에서 전달할려는 데이터의 수정일과 요청하는 데이터의 수정일을 비교해서 만료된 캐시라도 사용 가능하도록 응답
![image](https://github.com/SAMEZ-0129/HTTP_Web_Basic_Study/assets/81644075/ba41a9bf-bf19-470f-b865-3b555afd79c4)
응답을 주긴 하지만 기존에 요청한 데이터를 바디에 담아서 전달할 필요가 없기에(캐시 활용) 전송해야 되는 데이터의 양을 줄일 수 있다

클라이언트에서 기존 캐시가 유효하다는 요청을 위와 같이 받으면 기존 캐시를 갱신한다

해당 검증 헤더와 조건부 요청 헤더(if-modified-since = 이 일자 기준으로 변경됨?)를 같이 보내서 기존 캐시를 재사용할 수 있는지 파악 가능
![image](https://github.com/SAMEZ-0129/HTTP_Web_Basic_Study/assets/81644075/31a71ef5-45f8-446a-b533-51a7afa9d5c0)

검증 헤더
- 캐시 데이터와 서버 데이터가 같은지 검증하는 데이터
- Last-Modified, ETag

조건부 요청 헤더
- 검증 헤더로 조건에 따른 분기
- If-Modified-Since: Last-Modified 사용
- If-None-Match: ETag 사용
- 조건이 만족하면 200 OK
- 조건이 만족하지 않으면 304 Not Modified(304는 리다이렉션 응답인데? -> 캐시로 리다이렉션 하라는 뜻)
![image](https://github.com/SAMEZ-0129/HTTP_Web_Basic_Study/assets/81644075/31f0f03b-eef4-4abd-9a41-160cce22e631)

단점
![image](https://github.com/SAMEZ-0129/HTTP_Web_Basic_Study/assets/81644075/123153d1-6349-4a3e-8535-84f03fe787f3)

이때 사용 가능한 것이 ETag
![image](https://github.com/SAMEZ-0129/HTTP_Web_Basic_Study/assets/81644075/d770392a-d087-4d04-a2e3-58a0391742fa)
동일한 파일은 동일한 해시 값으로 나옴(컨텐츠가 실제로 변경되었는지 확인할 수 있음)
![image](https://github.com/SAMEZ-0129/HTTP_Web_Basic_Study/assets/81644075/0b757f7e-170f-4c99-a665-eccb1f6cb860)
서버가 일종의 블랙박스 역할을 하는 것
